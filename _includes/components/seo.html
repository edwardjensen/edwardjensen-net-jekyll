{% comment %}
  SEO Meta Tags Include
  Place in _includes/components/seo.html
  Include in header-includes.html: {% include components/seo.html %}
{% endcomment %}

{%- assign page_title = page.title | default: site.title -%}
{%- comment -%}
  Description fallback chain: excerpt > caption (photography) > description > title > site.description
  Note: escape filter required for HTML attribute safety (curly quotes, etc.)
{%- endcomment -%}
{%- if page.caption -%}
  {%- assign page_description = page.caption | strip_newlines -%}
{%- else -%}
  {%- assign page_description = page.excerpt | default: page.description | default: page.title | default: site.description | strip_html | strip_newlines -%}
{%- endif -%}
{%- assign page_url = page.url | absolute_url -%}
{%- assign page_image = page.image.url | default: page.image | default: site.logo | absolute_url -%}
{%- assign page_image_alt = page.image.alt | default: page.imageAlt | default: page.image_alt | default: page_title -%}

{%- if page.date -%}
  {%- assign is_article = true -%}
  {%- assign og_type = "article" -%}
{%- else -%}
  {%- assign is_article = false -%}
  {%- assign og_type = "website" -%}
{%- endif -%}

<!-- Jekyll SEO Tags -->
<title>{{ page_title | escape }}{% if page_title != site.title %} | {{ site.title | escape }}{% endif %}</title>
<meta name="description" content="{{ page_description | escape }}">
<link rel="canonical" href="{{ page_url }}">

<!-- Open Graph (Facebook, LinkedIn, Bluesky, Mastodon) -->
<meta property="og:title" content="{{ page_title | escape }}">
<meta property="og:description" content="{{ page_description | escape }}">
<meta property="og:url" content="{{ page_url }}">
<meta property="og:site_name" content="{{ site.title | escape }}">
<meta property="og:locale" content="{{ site.lang | default: 'en_US' | replace: '-', '_' }}">
<meta property="og:type" content="{{ og_type }}">
<meta property="og:image" content="{{ page_image }}">
<meta property="og:image:alt" content="{{ page_image_alt | escape }}">
{%- if is_article %}
<meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
{%- if page.modified_date or page.updatedAt %}
<meta property="article:modified_time" content="{{ page.modified_date | default: page.updatedAt | date_to_xmlschema }}">
{%- endif %}
<meta property="article:author" content="{{ site.social.name | default: site.title }}">
{%- endif %}

<!-- LinkedIn-specific format -->
<meta name="image" property="og:image" content="{{ page_image }}">

<!-- Twitter/X Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ page_title | escape}}">
<meta name="twitter:description" content="{{ page_description | escape }}">
<meta name="twitter:image" content="{{ page_image | escape }}">
<meta name="twitter:image:alt" content="{{ page_image_alt | escape }}">
{%- if site.twitter_username %}
<meta name="twitter:site" content="@{{ site.twitter_username | escape }}">
{%- endif %}

<!-- Google Site Verification -->
{%- if site.google_site_verification %}
<meta name="google-site-verification" content="{{ site.google_site_verification }}">
{%- endif %}

<!-- JSON-LD Structured Data -->
<script type="application/ld+json">
{%- if is_article %}
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": {{ page_title | jsonify }},
  "description": {{ page_description | jsonify }},
  "url": {{ page_url | jsonify }},
  "image": {{ page_image | jsonify }},
  "datePublished": "{{ page.date | date_to_xmlschema }}",
    "dateModified": "{{ page.modified_date | default: page.updatedAt | default: page.date | date_to_xmlschema }}",
    "author": {
        "@type": "Person",
        "name": {{ site.social.name | jsonify }}
        {%- if site.social.url %},
        "url": {{ site.social.url | jsonify }}
        {%- endif %}
        {%- if site.social.links %},
        "sameAs": {{ site.social.links | jsonify }}
        {%- endif %}
    },
  "publisher": {
    "@type": "Organization",
    "name": {{ site.title | jsonify }},
    "logo": {
      "@type": "ImageObject",
      "url": {{ site.logo | absolute_url | jsonify }}
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": {{ page_url | jsonify }}
  }
}
{%- else %}
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": {{ page_title | jsonify }},
  "description": {{ page_description | jsonify }},
  "url": {{ page_url | jsonify }},
  "author": {
    "@type": "Person",
    "name": {{ site.social.name | jsonify }}
    {%- if site.social.url %},
    "url": {{ site.social.url | jsonify }}
    {%- endif %}
    {%- if site.social.links %},
    "sameAs": {{ site.social.links | jsonify }}
    {%- endif %}
  },
  "publisher": {
    "@type": "Organization",
    "name": {{ site.title | jsonify }},
    "logo": {
      "@type": "ImageObject",
      "url": {{ site.logo | absolute_url | jsonify }}
    }
  }
}
{%- endif %}
</script>
<!-- End Jekyll SEO Tags -->